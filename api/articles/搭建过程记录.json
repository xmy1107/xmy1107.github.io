{"title":"搭建过程记录","uid":"f3e053b17563d4376eb93323aa914ede","slug":"搭建过程记录","date":"2024-11-07T03:07:08.000Z","updated":"2024-12-19T06:59:14.505Z","comments":true,"path":"api/articles/搭建过程记录.json","keywords":null,"cover":[],"content":"<p><a href=\"https://hexo.io/zh-cn/docs/\">hexo官方文档</a></p>\n<p>以下是自己的搭建过程（包括怎么git）：</p>\n<h1>1. 建立名为 <strong><a href=\"http://username.github.io\">username.github.io</a></strong>的储存库</h1>\n<h1>2. first commit</h1>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~$ <span class=\"built_in\">mkdir</span> blog</span><br><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~$ <span class=\"built_in\">cd</span> blog</span><br><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~/blog$ hexo init</span><br><span class=\"line\">INFO  Cloning hexo-starter https://github.com/hexojs/hexo-starter.git</span><br><span class=\"line\">INFO  Install dependencies</span><br><span class=\"line\">INFO  Start blogging with Hexo!</span><br><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~/blog$  git push -u origin main</span><br><span class=\"line\">fatal: 不是 git 仓库（或者直至挂载点 / 的任何父目录）</span><br><span class=\"line\">停止在文件系统边界（未设置 GIT_DISCOVERY_ACROSS_FILESYSTEM）。</span><br></pre></td></tr></table></figure>\n<p>完全按hexo步骤来会在这步卡住，因为git仓库都没有初始化</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~/blog$ <span class=\"built_in\">echo</span> <span class=\"string\">\"# xmy1107.github.io\"</span> &gt;&gt; README.md</span><br><span class=\"line\">（这里漏了git init，这个记得输入）</span><br><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~/blog$ git add README.md</span><br><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~/blog$ git commit -m <span class=\"string\">\"first commit\"</span></span><br><span class=\"line\">[main （根提交） 8956e78] first commit</span><br><span class=\"line\"> 1 file changed, 1 insertion(+)</span><br><span class=\"line\"> create mode 100644 README.md</span><br><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~/blog$ git remote add origin https://github.com/xmy1107/xmy1107.github.io.git</span><br><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~/blog$ git push -u origin main</span><br><span class=\"line\">Username <span class=\"keyword\">for</span> <span class=\"string\">'https://github.com'</span>: xmy1107</span><br><span class=\"line\">Password <span class=\"keyword\">for</span> <span class=\"string\">'https://xmy1107@github.com'</span>: </span><br></pre></td></tr></table></figure>\n<p>这里初始化并进行第一次提交以后就建站成功了。注意password不是你用户的密码，而是personal access token。如果是ssh连接就是这样（我用PAT能登进去，但每次都要重新输入，但用ssh在把公钥放进去以后不用这样，就用ssh了）：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~/blog$ git remote get-url origin</span><br><span class=\"line\">https://github.com/xmy1107/xmy1107.github.io.git</span><br><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~/blog$ git remote set-url origin git@github.com:xmy1107/xmy1107.github.io.git</span><br><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~/blog$ git remote get-url origin</span><br><span class=\"line\">git@github.com:xmy1107/xmy1107.github.io.git</span><br><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~/blog$ git push -u origin main</span><br><span class=\"line\">枚举对象中: 3, 完成.</span><br><span class=\"line\">对象计数中: 100% (3/3), 完成.</span><br><span class=\"line\">写入对象中: 100% (3/3), 227 字节 | 227.00 KiB/s, 完成.</span><br><span class=\"line\">总共 3（差异 0），复用 0（差异 0），包复用 0</span><br><span class=\"line\">To github.com:xmy1107/xmy1107.github.io.git</span><br><span class=\"line\"> * [new branch]      main -&gt; main</span><br><span class=\"line\">分支 <span class=\"string\">'main'</span> 设置为跟踪 <span class=\"string\">'origin/main'</span>。</span><br></pre></td></tr></table></figure>\n<p>然后在 <strong><a href=\"https://xmy1107.github.io/\">https://xmy1107.github.io/</a></strong> 下就有一个空的网页：</p>\n<p><img src=\"%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/image-20240925132827002.png\" alt=\"image-20240925132827002\"></p>\n<p>ps：PAT想要不每次输密码可以尝试</p>\n<p><code>vim ~/.gitconfig</code>后输入以下内容（虽然我没成功）</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[init]</span><br><span class=\"line\">        defaultBranch = main</span><br><span class=\"line\">[user]</span><br><span class=\"line\">        name = </span><br><span class=\"line\">        email = </span><br><span class=\"line\">[github]</span><br><span class=\"line\">        token = </span><br></pre></td></tr></table></figure>\n<h1>3. 网站正式建立</h1>\n<p>上面是因为只push了一个README，下面对github工作流配置后再次push可以得到”正常“的一个网页</p>\n<ol>\n<li>\n<p>使用 <code>node --version</code> 指令检查你电脑上的 Node.js 版本。 记下主要版本（我是<code>v20.17.0</code>）</p>\n</li>\n<li>\n<p>在储存库中前往 <strong>Settings</strong> &gt; <strong>Pages</strong> &gt; <strong>Source</strong> 。 将 source 更改为 <strong>GitHub Actions</strong>，然后保存。</p>\n</li>\n<li>\n<p>在储存库中建立 <code>.github/workflows/pages.yml</code>，并填入以下内容 (将 <code>20</code> 替换为上个步骤中记下的版本)：</p>\n</li>\n</ol>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">.github/workflows/pages.ymlname:</span> <span class=\"string\">Pages</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">on:</span></span><br><span class=\"line\">  <span class=\"attr\">push:</span></span><br><span class=\"line\">    <span class=\"attr\">branches:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">main</span> <span class=\"comment\"># default branch</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobs:</span></span><br><span class=\"line\">  <span class=\"attr\">build:</span></span><br><span class=\"line\">    <span class=\"attr\">runs-on:</span> <span class=\"string\">ubuntu-latest</span></span><br><span class=\"line\">    <span class=\"attr\">steps:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">uses:</span> <span class=\"string\">actions/checkout@v4</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">          <span class=\"attr\">token:</span> <span class=\"string\">${{</span> <span class=\"string\">secrets.GITHUB_TOKEN</span> <span class=\"string\">}}</span></span><br><span class=\"line\">          <span class=\"comment\"># If your repository depends on submodule, please see: https://github.com/actions/checkout</span></span><br><span class=\"line\">          <span class=\"attr\">submodules:</span> <span class=\"string\">recursive</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Use</span> <span class=\"string\">Node.js</span> <span class=\"number\">20</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">actions/setup-node@v4</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">          <span class=\"comment\"># Examples: 20, 18.19, &gt;=16.20.2, lts/Iron, lts/Hydrogen, *, latest, current, node</span></span><br><span class=\"line\">          <span class=\"comment\"># Ref: https://github.com/actions/setup-node#supported-version-syntax</span></span><br><span class=\"line\">          <span class=\"attr\">node-version:</span> <span class=\"string\">\"20\"</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Cache</span> <span class=\"string\">NPM</span> <span class=\"string\">dependencies</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">actions/cache@v4</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">          <span class=\"attr\">path:</span> <span class=\"string\">node_modules</span></span><br><span class=\"line\">          <span class=\"attr\">key:</span> <span class=\"string\">${{</span> <span class=\"string\">runner.OS</span> <span class=\"string\">}}-npm-cache</span></span><br><span class=\"line\">          <span class=\"attr\">restore-keys:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">            ${{ runner.OS }}-npm-cache</span></span><br><span class=\"line\"><span class=\"string\"></span>      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Install</span> <span class=\"string\">Dependencies</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">npm</span> <span class=\"string\">install</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Build</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">npm</span> <span class=\"string\">run</span> <span class=\"string\">build</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Upload</span> <span class=\"string\">Pages</span> <span class=\"string\">artifact</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">actions/upload-pages-artifact@v3</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">          <span class=\"attr\">path:</span> <span class=\"string\">./public</span></span><br><span class=\"line\">  <span class=\"attr\">deploy:</span></span><br><span class=\"line\">    <span class=\"attr\">needs:</span> <span class=\"string\">build</span></span><br><span class=\"line\">    <span class=\"attr\">permissions:</span></span><br><span class=\"line\">      <span class=\"attr\">pages:</span> <span class=\"string\">write</span></span><br><span class=\"line\">      <span class=\"attr\">id-token:</span> <span class=\"string\">write</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">      <span class=\"attr\">name:</span> <span class=\"string\">github-pages</span></span><br><span class=\"line\">      <span class=\"attr\">url:</span> <span class=\"string\">${{</span> <span class=\"string\">steps.deployment.outputs.page_url</span> <span class=\"string\">}}</span></span><br><span class=\"line\">    <span class=\"attr\">runs-on:</span> <span class=\"string\">ubuntu-latest</span></span><br><span class=\"line\">    <span class=\"attr\">steps:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Deploy</span> <span class=\"string\">to</span> <span class=\"string\">GitHub</span> <span class=\"string\">Pages</span></span><br><span class=\"line\">        <span class=\"attr\">id:</span> <span class=\"string\">deployment</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">actions/deploy-pages@v4</span></span><br></pre></td></tr></table></figure>\n<p>这个过程相当于<code>hexo generate</code>和<code>hexo deploy</code>，区别是在<code>git push</code>时才执行，然后用github工作流完成渲染和部署。</p>\n<p>这一步结束后重新打开博客便是如下页面：</p>\n<p><img src=\"%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/image-20240925134647445.png\" alt=\"image-20240925134647445\"></p>\n<ol start=\"4\">\n<li>部署完成后，前往 <em>username</em>.github.io/<em>repository</em> 查看网页。</li>\n</ol>\n<h1>4.一键部署</h1>\n<ol>\n<li>安装 <a href=\"https://github.com/hexojs/hexo-deployer-git\">hexo-deployer-git</a>，即输入<code>npm install hexo-deployer-git --save</code></li>\n<li>在 <code>_config.yml</code> 中添加以下配置（如果配置已经存在，请将其替换为如下）:</li>\n</ol>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\">  <span class=\"attr\">type:</span> <span class=\"string\">git</span></span><br><span class=\"line\">  <span class=\"attr\">repo:</span> <span class=\"string\">https://github.com/&lt;username&gt;/&lt;project&gt;</span></span><br><span class=\"line\">  <span class=\"comment\"># example, https://github.com/hexojs/hexojs.github.io</span></span><br><span class=\"line\">  <span class=\"comment\"># 我这里是git@github.com:xmy1107/xmy1107.github.io.git，因为我是ssh连接的</span></span><br><span class=\"line\">  <span class=\"comment\"># git@github.com:xmy1107/blog.git是项目页面</span></span><br><span class=\"line\">  <span class=\"attr\">branch:</span> <span class=\"string\">main</span> <span class=\"comment\"># hexo给的是gh-pages，无所谓</span></span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>这里要把网站建立中<strong>GitHub Actions</strong>改回<strong>Deploy from a branch</strong>，因为使用 <code>hexo d</code> 时，它会跳过 GitHub Actions，直接将 <code>public</code> 文件夹中的静态文件推送到 <code>gh-pages</code> 分支。 GitHub Actions对应的操作是<code>git push</code></li>\n<li>执行 <code>hexo clean &amp;&amp; hexo deploy</code> 。</li>\n<li>浏览 <em>username</em>.github.io，检查你的网站能否运作。</li>\n</ol>\n<h1>5.后续配置</h1>\n<p>主题选用<a href=\"https://github.com/PhosphorW/hexo-theme-academia\">Academia</a></p>\n<p>改用<a href=\"https://github.com/auroral-ui/hexo-theme-aurora\">aurora</a></p>\n<h1>6.Aurora</h1>\n<p>见<a href=\"https://aurora.tridiamond.tech/cn/guide/getting-started.html\">doc</a></p>\n<h2 id=\"Gitalk\">Gitalk</h2>\n<p>创建一个 comments 仓库，配置一下 OAuth App 即可</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">gitalk:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">autoExpand:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">clientID:</span> <span class=\"string\">''</span></span><br><span class=\"line\">  <span class=\"attr\">clientSecret:</span> <span class=\"string\">''</span></span><br><span class=\"line\">  <span class=\"attr\">repo:</span> <span class=\"string\">'blog-comments'</span> <span class=\"comment\">## dev-blo-comments</span></span><br><span class=\"line\">  <span class=\"attr\">owner:</span> <span class=\"string\">'xmy1107'</span> <span class=\"comment\">## owner name</span></span><br><span class=\"line\">  <span class=\"attr\">admin:</span> [<span class=\"string\">'xmy1107'</span>] <span class=\"comment\">## ['admin_name']</span></span><br><span class=\"line\">  <span class=\"attr\">id:</span> <span class=\"string\">location.pathname</span></span><br><span class=\"line\">  <span class=\"attr\">language:</span> <span class=\"string\">en</span></span><br><span class=\"line\">  <span class=\"attr\">distractionFreeMode:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">recentComment:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">proxy:</span> <span class=\"string\">''</span></span><br></pre></td></tr></table></figure>\n<p>开始一直无法启用是因为一直在本地测试，而 GitHub OAuth 不允许本地地址作为 Authorization callback URL，redirect_uri 一直与其冲突。部署上去就大功告成了！</p>\n<h2 id=\"对话功能\">对话功能</h2>\n<p>一个简单的示例：</p>\n<p><img src=\"./%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/ask.png\" alt=\"\"> <img src=\"./%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/answer.png\" alt=\"\"></p>\n<p>在<code>/home/xmy/blog/node_modules/hexo-theme-aurora/layout</code>下修改index.ejs中代码为：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">\"en\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"UTF-8\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"X-UA-Compatible\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"IE=edge\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width,initial-scale=1\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"icon\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"/favicon.ico\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"module\"</span> <span class=\"attr\">crossorigin</span> <span class=\"attr\">src</span>=<span class=\"string\">\"/static/js/120aa8f8.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"/static/css/a14e1a22.css\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 引入 KaTeX --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 引入 marked.js 和 DOMPurify 库 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdn.jsdelivr.net/npm/marked/marked.min.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdn.jsdelivr.net/npm/dompurify@2.4.0/dist/purify.min.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span> <span class=\"attr\">id</span>=<span class=\"string\">\"body-container\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">noscript</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">strong</span>&gt;</span>We're sorry but this app doesn't work properly without JavaScript enabled.</span><br><span class=\"line\">            Please enable it to continue.<span class=\"tag\">&lt;/<span class=\"name\">strong</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">noscript</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"app\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- Aurora 机器人聊天框，固定在页面左下角 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"aurora-chatbox\"</span> <span class=\"attr\">style</span>=<span class=\"string\">\"</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    position: fixed;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    bottom: 200px;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    left: 20px;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    width: 300px;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    background-color: #f9f9f9;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    padding: 10px;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    border: 1px solid #ddd;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    border-radius: 8px;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    box-shadow: 0 2px 5px rgba(0,0,0,0.1);</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    z-index: 9999;\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">style</span>=<span class=\"string\">\"margin: 0; font-size: 14px; color: #333;\"</span>&gt;</span>随便问点啥<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"userInput\"</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">\"输入你的问题...\"</span> </span></span><br><span class=\"line\"><span class=\"tag\">            <span class=\"attr\">style</span>=<span class=\"string\">\"width: 100%; padding: 5px; margin-top: 5px; border-radius: 4px; border: 1px solid #ccc;\"</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">id</span>=<span class=\"string\">\"sendMessage\"</span> <span class=\"attr\">style</span>=<span class=\"string\">\"</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">            margin-top: 5px; </span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">            width: 100%; </span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">            padding: 5px; </span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">            background-color: #007bff; </span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">            color: #fff; </span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">            border: none; </span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">            border-radius: 4px; </span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">            cursor: pointer;\"</span>&gt;</span></span><br><span class=\"line\">            发送</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"responseBox\"</span> <span class=\"attr\">style</span>=<span class=\"string\">\"margin-top: 10px; font-size: 12px; color: #555;\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- JavaScript 逻辑 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">const</span> <span class=\"variable constant_\">API_KEY</span> = <span class=\"string\">\"YOUR-API-KEY\"</span>; <span class=\"comment\">// 替换为你的 OpenAI API 密钥</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">const</span> <span class=\"variable constant_\">API_URL</span> = <span class=\"string\">\"https://api.openai.com/v1/chat/completions\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"comment\">// 发送消息的逻辑封装成函数</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">sendMessage</span>(<span class=\"params\"></span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">const</span> userInput = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">\"userInput\"</span>).<span class=\"property\">value</span>.<span class=\"title function_\">trim</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">const</span> responseBox = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">\"responseBox\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">if</span> (!userInput) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                responseBox.<span class=\"property\">innerText</span> = <span class=\"string\">\"请输入你的问题！\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">return</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            }</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">            responseBox.<span class=\"property\">innerText</span> = <span class=\"string\">\"思考中，请稍等...\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">try</span> {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"comment\">// 发起 API 请求</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">const</span> response = <span class=\"keyword\">await</span> <span class=\"title function_\">fetch</span>(<span class=\"variable constant_\">API_URL</span>, {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"attr\">method</span>: <span class=\"string\">\"POST\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"attr\">headers</span>: {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"application/json\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"string\">\"Authorization\"</span>: <span class=\"string\">`Bearer <span class=\"subst\">${API_KEY}</span>`</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"attr\">body</span>: <span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>({</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">model</span>: <span class=\"string\">\"gpt-4o-mini\"</span>, <span class=\"comment\">// 使用 GPT-4o-mini</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">messages</span>: [</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">role</span>: <span class=\"string\">\"system\"</span>, <span class=\"attr\">content</span>: <span class=\"string\">\"你是一个网站的助手，下面我会给你一些这个网站的相关信息。\\</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"language-javascript\">                            \\n网站的主人叫虚名羊，网站是用hexo搭建的，网站链接是https://xmy1107.github.io/，\\</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"language-javascript\">                            内容以技术和生活为主。\\n请确保所有包含数学公式的回答使用 Markdown 格式输出。\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">role</span>: <span class=\"string\">\"user\"</span>, <span class=\"attr\">content</span>: userInput }</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        ]</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    })</span></span><br><span class=\"line\"><span class=\"language-javascript\">                });</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">if</span> (!response.<span class=\"property\">ok</span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Error</span>(<span class=\"string\">\"API 请求失败，请检查网络或密钥。\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">                }</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">const</span> data = <span class=\"keyword\">await</span> response.<span class=\"title function_\">json</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">const</span> gptResponse = data.<span class=\"property\">choices</span>[<span class=\"number\">0</span>].<span class=\"property\">message</span>.<span class=\"property\">content</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">\"GPT Response:\"</span>, gptResponse);</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"comment\">// 1. 提前替换数学公式为占位符，避免被 marked 破坏</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">const</span> placeholder = <span class=\"string\">'%%MATH_FORMULA%%'</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">let</span> mathBlocks = [];</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"comment\">// const preprocessedResponse = gptResponse.replace(/\\\\\\[([^\\]]+)\\\\\\]|\\\\\\(([^\\)]+)\\\\\\)/g, (match) =&gt; {</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"comment\">//     mathBlocks.push(match);</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"comment\">//     return placeholder;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"comment\">// });</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">const</span> preprocessedResponse = gptResponse.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/\\\\\\[.*?\\\\\\]|\\\\\\(.*?\\\\\\)/g</span>s, <span class=\"function\">(<span class=\"params\">match</span>) =&gt;</span> {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    mathBlocks.<span class=\"title function_\">push</span>(match);</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"keyword\">return</span> placeholder;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                });</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"comment\">// 2. 使用 marked 渲染 Markdown</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">const</span> renderedHTML = marked.<span class=\"title function_\">parse</span>(preprocessedResponse);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"comment\">// 3. 替换回原始数学公式</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">let</span> finalHTML = renderedHTML;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                mathBlocks.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">math, i</span>) =&gt;</span> {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    finalHTML = finalHTML.<span class=\"title function_\">replace</span>(placeholder, math);</span></span><br><span class=\"line\"><span class=\"language-javascript\">                });</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"comment\">// 4. 安全地插入 HTML</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                responseBox.<span class=\"property\">innerHTML</span> = <span class=\"title class_\">DOMPurify</span>.<span class=\"title function_\">sanitize</span>(finalHTML);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"comment\">// 5. 渲染数学公式</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"title function_\">renderMathInElement</span>(responseBox, {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"attr\">delimiters</span>: [</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        { <span class=\"attr\">left</span>: <span class=\"string\">\"\\\\(\"</span>, <span class=\"attr\">right</span>: <span class=\"string\">\"\\\\)\"</span>, <span class=\"attr\">display</span>: <span class=\"literal\">false</span> }, <span class=\"comment\">// 行内公式</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                        { <span class=\"attr\">left</span>: <span class=\"string\">\"\\\\[\"</span>, <span class=\"attr\">right</span>: <span class=\"string\">\"\\\\]\"</span>, <span class=\"attr\">display</span>: <span class=\"literal\">true</span> }  <span class=\"comment\">// 块级公式</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    ],</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"attr\">throwOnError</span>: <span class=\"literal\">false</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                });</span></span><br><span class=\"line\"><span class=\"language-javascript\">            } <span class=\"keyword\">catch</span> (error) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                responseBox.<span class=\"property\">innerText</span> = <span class=\"string\">\"抱歉，出错了：\"</span> + error.<span class=\"property\">message</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            }</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"comment\">// 清空输入框</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">\"userInput\"</span>).<span class=\"property\">value</span> = <span class=\"string\">\"\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        }</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"comment\">// 点击发送按钮触发</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">\"sendMessage\"</span>).<span class=\"title function_\">addEventListener</span>(<span class=\"string\">\"click\"</span>, sendMessage);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"comment\">// 回车键监听输入框</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">\"userInput\"</span>).<span class=\"title function_\">addEventListener</span>(<span class=\"string\">\"keydown\"</span>, <span class=\"keyword\">function</span> (<span class=\"params\">event</span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">if</span> (event.<span class=\"property\">key</span> === <span class=\"string\">\"Enter\"</span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                event.<span class=\"title function_\">preventDefault</span>(); <span class=\"comment\">// 阻止默认行为（如提交表单）</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"title function_\">sendMessage</span>(); <span class=\"comment\">// 调用发送消息函数</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">            }</span></span><br><span class=\"line\"><span class=\"language-javascript\">        });</span></span><br><span class=\"line\"><span class=\"language-javascript\">    </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>令我最头疼的点：正则表达式识别<br>\n小小记录下：</p>\n<p><code>.*?：非贪婪匹配，匹配中间的任意字符，直到遇到下一个 \\] 为止。</code></p>\n<p><code>s 标志：启用 dotall 模式，使 . 匹配换行符。</code></p>\n<p><code>g 标志：全局匹配。</code></p>\n<p>upd：改kimi ai了，gpt有的人可能用不了。</p>\n<h1>一些自己写博客的注意点</h1>\n<h2 id=\"关于贴html\">关于贴html</h2>\n<p>贴html用相对路径：<code>[去各地比赛的地图，标签可拖动](/map_html/index.html)</code></p>\n<p>贴图片用绝对路径：<code>![image-20240925134647445](搭建过程记录/image-20240925134647445.png)</code>，便于显示</p>\n<p>html文件要禁止渲染，默认会渲染并且放进page目录中。需要在config中加入以下配置：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">skip_render:</span><br><span class=\"line\">  htmls/**/*.html</span><br></pre></td></tr></table></figure>\n<p>要放进地址栏的部分得用英文字符，但只是文件链接就不用</p>\n<p><code>[双放手录视频+唱歌，九十度弯摔了](/htmls/双放手.html)</code></p>\n<p>html文件中是</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">video</span> <span class=\"attr\">controls</span> <span class=\"attr\">width</span>=<span class=\"string\">\"500\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">source</span> <span class=\"attr\">src</span>=<span class=\"string\">\"/videos/shuangfangshou.mp4\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"video/mp4\"</span>&gt;</span></span><br><span class=\"line\">    您的浏览器不支持视频标签。</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">video</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"本地的目录，供以后参考\">本地的目录，供以后参考</h2>\n<p><img src=\"%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/QQ20241209-231620.png\" alt=\"\"></p>\n<h2 id=\"hexo-s后台运行\">hexo s后台运行</h2>\n<p><img src=\"./%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/houtai.png\" alt=\"\"></p>\n<h2 id=\"数学公式\">数学公式</h2>\n<p><a href=\"https://github.com/next-theme/hexo-filter-mathjax\">hexo-filter-mathjax</a></p>\n<p>记得<code>front-matter</code>里加上<code>mathjax: true</code></p>\n<p>公式换行需要<code>\\\\\\\\</code></p>\n<h1>TODO LIST</h1>\n<p>小机器人可以想办法搞得更生动一点<br>\n用nodejs啥的把api封装到后端（目前感觉没啥关系，小白不在乎安全性）<br>\n代码高亮真的搞不好，主题必须要shiki高亮引擎，而shiki是一个ES Module，与hexo环境不兼容。</p>\n<h1>没搞清楚的部分</h1>\n<h2 id=\"项目页面（这部分没完全搞清楚）\">项目页面（这部分没完全搞清楚）</h2>\n<ol>\n<li>导航到 GitHub 上的存储库。 转到 <strong>Settings</strong> 选项卡。 建立名为 <code>&lt;repository 的名字&gt;</code> 的储存库，这样你的博客网址为 <code>&lt;你的 GitHub 用户名&gt;.github.io/&lt;repository 的名字&gt;</code>，repository 的名字可以任意，例如 blog 或 hexo。</li>\n<li>编辑你的 <code>_config.yml</code>，将 <code>url:</code> 更改为 <code>&lt;你的 GitHub 用户名&gt;.github.io/&lt;repository 的名字&gt;</code>。</li>\n<li>在 GitHub 仓库的设置中，导航至 <strong>Settings</strong> &gt; <strong>Pages</strong> &gt; <strong>Source</strong> 。 将 source 更改为 <strong>GitHub Actions</strong>，然后保存。</li>\n<li>Commit 并 push 到默认分支上。</li>\n</ol>\n<p>注意这里要修改远程的仓库，需要push到新建的那个仓库中</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~/blog$ git remote set-url origin git@github.com:xmy1107/blog.git</span><br><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~/blog$ git remote -v</span><br><span class=\"line\">origin\tgit@github.com:xmy1107/blog.git (fetch)</span><br><span class=\"line\">origin\tgit@github.com:xmy1107/blog.git (push)</span><br><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~/blog$ git add .</span><br><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~/blog$ git status</span><br><span class=\"line\">位于分支 main</span><br><span class=\"line\">您的分支与上游分支 <span class=\"string\">'origin/main'</span> 一致。</span><br><span class=\"line\"></span><br><span class=\"line\">要提交的变更：</span><br><span class=\"line\">  （使用 <span class=\"string\">\"git restore --staged &lt;文件&gt;...\"</span> 以取消暂存）</span><br><span class=\"line\">\t修改：     _config.yml</span><br><span class=\"line\"></span><br><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~/blog$ git commit -m <span class=\"string\">\"first commit\"</span></span><br><span class=\"line\">[main fa6cdc7] first commit</span><br><span class=\"line\"> 1 file changed, 1 insertion(+), 1 deletion(-)</span><br><span class=\"line\">(base) xmy@xmy-Z790M-AORUS-ELITE-AX:~/blog$ git push</span><br><span class=\"line\">枚举对象中: 30, 完成.</span><br><span class=\"line\">对象计数中: 100% (30/30), 完成.</span><br><span class=\"line\">使用 16 个线程进行压缩</span><br><span class=\"line\">压缩对象中: 100% (19/19), 完成.</span><br><span class=\"line\">写入对象中: 100% (30/30), 31.32 KiB | 3.48 MiB/s, 完成.</span><br><span class=\"line\">总共 30（差异 3），复用 0（差异 0），包复用 0</span><br><span class=\"line\">remote: Resolving deltas: 100% (3/3), <span class=\"keyword\">done</span>.</span><br><span class=\"line\">To github.com:xmy1107/blog.git</span><br><span class=\"line\"> * [new branch]      main -&gt; main</span><br></pre></td></tr></table></figure>","text":"hexo官方文档 以下是自己的搭建过程（包括怎么git）： 1. 建立名为 username.github.io的储存库 2. first commit 123...","permalink":"/post/搭建过程记录","photos":[],"count_time":{"symbolsCount":"14k","symbolsTime":"12 mins."},"categories":[],"tags":[{"name":"杂","slug":"杂","count":2,"path":"api/tags/杂.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\"><span class=\"toc-text\">1. 建立名为 username.github.io的储存库</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\"><span class=\"toc-text\">2. first commit</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\"><span class=\"toc-text\">3. 网站正式建立</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\"><span class=\"toc-text\">4.一键部署</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\"><span class=\"toc-text\">5.后续配置</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\"><span class=\"toc-text\">6.Aurora</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Gitalk\"><span class=\"toc-text\">Gitalk</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AF%B9%E8%AF%9D%E5%8A%9F%E8%83%BD\"><span class=\"toc-text\">对话功能</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\"><span class=\"toc-text\">一些自己写博客的注意点</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%85%B3%E4%BA%8E%E8%B4%B4html\"><span class=\"toc-text\">关于贴html</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9C%AC%E5%9C%B0%E7%9A%84%E7%9B%AE%E5%BD%95%EF%BC%8C%E4%BE%9B%E4%BB%A5%E5%90%8E%E5%8F%82%E8%80%83\"><span class=\"toc-text\">本地的目录，供以后参考</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#hexo-s%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C\"><span class=\"toc-text\">hexo s后台运行</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8F\"><span class=\"toc-text\">数学公式</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\"><span class=\"toc-text\">TODO LIST</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\"><span class=\"toc-text\">没搞清楚的部分</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%A1%B9%E7%9B%AE%E9%A1%B5%E9%9D%A2%EF%BC%88%E8%BF%99%E9%83%A8%E5%88%86%E6%B2%A1%E5%AE%8C%E5%85%A8%E6%90%9E%E6%B8%85%E6%A5%9A%EF%BC%89\"><span class=\"toc-text\">项目页面（这部分没完全搞清楚）</span></a></li></ol></li></ol>","author":{"name":"蜗角虚名羊","slug":"blog-author","avatar":"/pictures/logo.jpg","link":"/","description":"<p>暂时还没想到要说什么<br>但又不想留白</p>","socials":{"github":"https://github.com/xmy1107","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/xumingyang0","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"2024年度总结","uid":"a43501af752cd97a928bbdf7b9795fd7","slug":"2024年度总结","date":"2024-12-09T08:30:10.000Z","updated":"2024-12-19T05:12:25.011Z","comments":true,"path":"api/articles/2024年度总结.json","keywords":null,"cover":[],"text":"Part 1: ACM 比赛 去各地比赛的地图，试试拖动标签找到我的所有奖项 网页里写的很全了，我文字也写一下吧，中间有很多坎坷，也有很多心路历程，但已经在别处...","permalink":"/post/2024年度总结","photos":[],"count_time":{"symbolsCount":"3.2k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"杂","slug":"杂","count":2,"path":"api/tags/杂.json"}],"author":{"name":"蜗角虚名羊","slug":"blog-author","avatar":"/pictures/logo.jpg","link":"/","description":"<p>暂时还没想到要说什么<br>但又不想留白</p>","socials":{"github":"https://github.com/xmy1107","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/xumingyang0","juejin":"","customs":{}}},"feature":true},"next_post":{}}